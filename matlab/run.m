setup
prepare_data
calc_double
calc_state